"use strict";(self["webpackChunkforum_front_end_vue"]=self["webpackChunkforum_front_end_vue"]||[]).push([[691],{8691:function(t,r,e){e.r(r),e.d(r,{default:function(){return K}});var s=function(){var t=this,r=t.$createElement,e=t._self._c||r;return e("div",{staticClass:"container py-5"},[e("div",{staticClass:"row"},[e("UserProfileCard",{attrs:{profile:t.profile,currentUser:t.currentUser}})],1),e("div",{staticClass:"row"},[e("div",{staticClass:"col-4"},[e("UserFollowingsCard",{attrs:{profileFollowings:t.profile.Followings}}),e("UserFollowersCard",{attrs:{profileFollowers:t.profile.Followers}})],1),e("div",{staticClass:"col-8"},[e("UserCommentsCard",{attrs:{profileComments:t.profile.Comments}}),e("UserFavoritedRestaurantsCard",{attrs:{profileFavoritedRestaurants:t.profile.FavoritedRestaurants}})],1)])])},i=[],o=function(){var t=this,r=t.$createElement,e=t._self._c||r;return e("div",{staticClass:"container py-5"},[e("div",{staticClass:"row"},[e("div",{staticClass:"col-4"},[e("img",{attrs:{src:t._f("emptyImage")(t.profile.image),width:"250px",height:"250px"}})]),e("div",{staticClass:"col-8"},[e("div",[e("h3",[t._v(t._s(t.profile.name))]),e("h5",[t._v(t._s(t.profile.email))])]),e("br"),e("ul",[e("li",[t._v("已評論餐廳數： "+t._s(t.profile.Comments.length)+" ")]),e("li",[t._v("收藏餐廳數： "+t._s(t.profile.FavoritedRestaurants.length))]),e("li",[t._v("Followings(追蹤者)： "+t._s(t.profile.Followings.length))]),e("li",[t._v("Followers(追隨者)： "+t._s(t.profile.Followers.length))])]),t.isCurrentUser?[t.currentUser.id===t.profile.id?e("router-link",{staticClass:"btn btn-primary",attrs:{to:{name:"user-edit",params:{id:t.currentUser.id}}}},[t._v(" 編輯 ")]):t._e()]:[t.isFollowing?e("button",{staticClass:"btn btn-danger",attrs:{disabled:t.isProcessing,type:"button"},on:{click:function(r){return t.unFollowUser(t.profile.id)}}},[t._v(" 取消追蹤 ")]):e("button",{staticClass:"btn btn-primary",attrs:{disabled:t.isProcessing,type:"button"},on:{click:function(r){return t.followUser(t.profile.id)}}},[t._v(" 追蹤 ")])],e("button",{staticClass:"btn btn-link",attrs:{type:"button"},on:{click:function(r){return t.$router.back()}}},[t._v(" 回上一頁 ")])],2)])])},l=[],a=(e(1703),e(8247)),n=e(6017),c=e(1926);var u={mixins:[a.P],props:{profile:{type:Object,required:!0,default:()=>({})},currentUser:{type:Object,required:!0},isAuthenticated:{type:Boolean,required:!0}},data(){return{isProcessing:!1}},methods:{async followUser(t){try{this.isProcessing=!0;const{data:r}=await n.Z.addFollowing({userId:t});if("success"!==r.status)throw new Error(r.message);this.profile.Followers.push({id:this.currentUser.id}),this.isProcessing=!1}catch(r){this.isProcessing=!1,console.log("error",r),c.F.fire({icon:"error",title:"無法加入追蹤，請稍後再試"})}},async unFollowUser(t){try{this.isProcessing=!0;const{data:r}=await n.Z.deleteFollowing({userId:t});if("success"!==r.status)throw new Error(r.message);this.profile.Followers=this.profile.Followers.map((t=>t.id!==this.currentUser.id)),this.isProcessing=!1}catch(r){this.isProcessing=!1,console.log("error",r),c.F.fire({icon:"error",title:"無法取消追蹤，請稍後再試"})}}},computed:{isFollowing(){let t=!1;return this.profile.Followers.forEach((r=>{r.id===this.currentUser.id&&(t=!0)})),t},isCurrentUser(){let t=!1;return this.profile.id===this.currentUser.id&&(t=!0),t}},created(){}},d=u,p=e(1001),f=(0,p.Z)(d,o,l,!1,null,null,null),m=f.exports,h=function(){var t=this,r=t.$createElement,e=t._self._c||r;return e("div",{staticClass:"container  my-2"},[e("div",{staticClass:"row"},[e("h4",[t._v(" Followings(追蹤者)： "+t._s(t.profileFollowings.length)+" ")])]),e("div",{staticClass:"row"},t._l(t.profileFollowings,(function(r){return e("div",{key:r.id,staticClass:"col-4 mb-3"},[e("router-link",{attrs:{to:{name:"user",params:{id:r.id}}}},[e("img",{attrs:{src:t._f("emptyImage")(r.image),width:"100px",height:"100px"}})])],1)})),0)])},g=[],v={mixins:[a.P],props:{profileFollowings:{type:Array,required:!0,default:()=>[]}}},w=v,_=(0,p.Z)(w,h,g,!1,null,null,null),C=_.exports,F=function(){var t=this,r=t.$createElement,e=t._self._c||r;return e("div",{staticClass:"container my-2"},[e("div",{staticClass:"row"},[e("h4",[t._v(" Followers(追隨者)： "+t._s(t.profileFollowers.length)+" ")])]),e("div",{staticClass:"row"},t._l(t.profileFollowers,(function(r){return e("div",{key:r.id,staticClass:"col-4 mb-3"},[e("router-link",{attrs:{to:{name:"user",params:{id:r.id}}}},[e("img",{attrs:{src:t._f("emptyImage")(r.image),width:"100px",height:"100px"}})])],1)})),0)])},y=[],U={mixins:[a.P],props:{profileFollowers:{type:Array,required:!0,default:()=>[]}}},b=U,x=(0,p.Z)(b,F,y,!1,null,null,null),k=x.exports,P=function(){var t=this,r=t.$createElement,e=t._self._c||r;return e("div",{staticClass:"container my-2"},[e("div",{staticClass:"row"},[e("h4",[t._v(" 已評論餐廳數： "+t._s(t.profileComments.length)+" ")])]),e("div",{staticClass:"row"},t._l(t.profileComments,(function(r){return e("div",{key:r.id,staticClass:"col-2 mb-3"},[e("router-link",{attrs:{to:{name:"restaurant",params:{id:r.id}}}},[e("img",{attrs:{src:t._f("emptyImage")(r.Restaurant.image),width:"100px",height:"100px"}})])],1)})),0)])},R=[],E={mixins:[a.P],props:{profileComments:{type:Array,required:!0,default:()=>[]}}},Z=E,I=(0,p.Z)(Z,P,R,!1,null,null,null),$=I.exports,q=function(){var t=this,r=t.$createElement,e=t._self._c||r;return e("div",{staticClass:"container my-2"},[e("div",{staticClass:"row"},[e("h4",[t._v(" 收藏餐廳數： "+t._s(t.profileFavoritedRestaurants.length)+" ")])]),e("div",{staticClass:"row"},t._l(t.profileFavoritedRestaurants,(function(r){return e("div",{key:r.id,staticClass:"col-2 mb-3"},[e("router-link",{attrs:{to:{name:"restaurant",params:{id:r.id}}}},[e("img",{attrs:{src:t._f("emptyImage")(r.image),width:"100px",height:"100px"}})])],1)})),0)])},A=[],j={mixins:[a.P],props:{profileFavoritedRestaurants:{type:Array,required:!0,default:()=>[]}}},O=j,B=(0,p.Z)(O,q,A,!1,null,null,null),z=B.exports,D=e(4665);var G={name:"User",components:{UserProfileCard:m,UserFollowingsCard:C,UserFollowersCard:k,UserCommentsCard:$,UserFavoritedRestaurantsCard:z},data(){return{profile:{}}},computed:{...(0,D.rn)(["currentUser"])},methods:{async fetchUser(t){try{const{data:r}=await n.Z.get({userId:t});console.log("data",r),this.profile=r.profile}catch(r){console.log("error",r),c.F.fire({icon:"error",title:"無法取得 User 資料，請稍後再試"})}}},mounted(){const{id:t}=this.$route.params;this.fetchUser(t)},beforeRouteUpdate(t,r,e){const{id:s}=t.params;this.fetchUser(s),e()}},H=G,J=(0,p.Z)(H,s,i,!1,null,null,null),K=J.exports}}]);
//# sourceMappingURL=691.517794d5.js.map