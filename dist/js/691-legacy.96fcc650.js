"use strict";(self["webpackChunkforum_front_end_vue"]=self["webpackChunkforum_front_end_vue"]||[]).push([[691],{8691:function(r,e,t){t.r(e),t.d(e,{default:function(){return N}});var s=function(){var r=this,e=r.$createElement,t=r._self._c||e;return t("div",{staticClass:"container py-5"},[t("div",{staticClass:"row"},[t("UserProfileCard",{attrs:{profile:r.profile,currentUser:r.currentUser}})],1),t("div",{staticClass:"row"},[t("div",{staticClass:"col-4"},[t("UserFollowingsCard",{attrs:{profileFollowings:r.profile.Followings}}),t("UserFollowersCard",{attrs:{profileFollowers:r.profile.Followers}})],1),t("div",{staticClass:"col-8"},[t("UserCommentsCard",{attrs:{profileComments:r.profile.Comments}}),t("UserFavoritedRestaurantsCard",{attrs:{profileFavoritedRestaurants:r.profile.FavoritedRestaurants}})],1)])])},i=[],n=t(67906),o=t(16198),l=t(4367),a=function(){var r=this,e=r.$createElement,t=r._self._c||e;return t("div",{staticClass:"container py-5"},[t("div",{staticClass:"row"},[t("div",{staticClass:"col-4"},[t("img",{attrs:{src:r._f("emptyImage")(r.profile.image),width:"250px",height:"250px"}})]),t("div",{staticClass:"col-8"},[t("div",[t("h3",[r._v(r._s(r.profile.name))]),t("h5",[r._v(r._s(r.profile.email))])]),t("br"),t("ul",[t("li",[r._v("已評論餐廳數： "+r._s(r.profile.Comments.length)+" ")]),t("li",[r._v("收藏餐廳數： "+r._s(r.profile.FavoritedRestaurants.length))]),t("li",[r._v("Followings(追蹤者)： "+r._s(r.profile.Followings.length))]),t("li",[r._v("Followers(追隨者)： "+r._s(r.profile.Followers.length))])]),r.isCurrentUser?[r.currentUser.id===r.profile.id?t("router-link",{staticClass:"btn btn-primary",attrs:{to:{name:"user-edit",params:{id:r.currentUser.id}}}},[r._v(" 編輯 ")]):r._e()]:[r.isFollowing?t("button",{staticClass:"btn btn-danger",attrs:{disabled:r.isProcessing,type:"button"},on:{click:function(e){return r.unFollowUser(r.profile.id)}}},[r._v(" 取消追蹤 ")]):t("button",{staticClass:"btn btn-primary",attrs:{disabled:r.isProcessing,type:"button"},on:{click:function(e){return r.followUser(r.profile.id)}}},[r._v(" 追蹤 ")])],t("button",{staticClass:"btn btn-link",attrs:{type:"button"},on:{click:function(e){return r.$router.back()}}},[r._v(" 回上一頁 ")])],2)])])},c=[],u=(t(21703),t(21249),t(41539),t(54747),t(98247)),d=t(76017),p=t(41926),f={mixins:[u.P],props:{profile:{type:Object,required:!0,default:function(){return{}}},currentUser:{type:Object,required:!0},isAuthenticated:{type:Boolean,required:!0}},data:function(){return{isProcessing:!1}},methods:{followUser:function(r){var e=this;return(0,o.Z)((0,n.Z)().mark((function t(){var s,i;return(0,n.Z)().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,e.isProcessing=!0,t.next=4,d.Z.addFollowing({userId:r});case 4:if(s=t.sent,i=s.data,"success"===i.status){t.next=8;break}throw new Error(i.message);case 8:e.profile.Followers.push({id:e.currentUser.id}),e.isProcessing=!1,t.next=17;break;case 12:t.prev=12,t.t0=t["catch"](0),e.isProcessing=!1,console.log("error",t.t0),p.F.fire({icon:"error",title:"無法加入追蹤，請稍後再試"});case 17:case"end":return t.stop()}}),t,null,[[0,12]])})))()},unFollowUser:function(r){var e=this;return(0,o.Z)((0,n.Z)().mark((function t(){var s,i;return(0,n.Z)().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,e.isProcessing=!0,t.next=4,d.Z.deleteFollowing({userId:r});case 4:if(s=t.sent,i=s.data,"success"===i.status){t.next=8;break}throw new Error(i.message);case 8:e.profile.Followers=e.profile.Followers.map((function(r){return r.id!==e.currentUser.id})),e.isProcessing=!1,t.next=17;break;case 12:t.prev=12,t.t0=t["catch"](0),e.isProcessing=!1,console.log("error",t.t0),p.F.fire({icon:"error",title:"無法取消追蹤，請稍後再試"});case 17:case"end":return t.stop()}}),t,null,[[0,12]])})))()}},computed:{isFollowing:function(){var r=this,e=!1;return this.profile.Followers.forEach((function(t){t.id===r.currentUser.id&&(e=!0)})),e},isCurrentUser:function(){var r=!1;return this.profile.id===this.currentUser.id&&(r=!0),r}},created:function(){}},m=f,v=t(1001),h=(0,v.Z)(m,a,c,!1,null,null,null),w=h.exports,g=function(){var r=this,e=r.$createElement,t=r._self._c||e;return t("div",{staticClass:"container  my-2"},[t("div",{staticClass:"row"},[t("h4",[r._v(" Followings(追蹤者)： "+r._s(r.profileFollowings.length)+" ")])]),t("div",{staticClass:"row"},r._l(r.profileFollowings,(function(e){return t("div",{key:e.id,staticClass:"col-4 mb-3"},[t("router-link",{attrs:{to:{name:"user",params:{id:e.id}}}},[t("img",{attrs:{src:r._f("emptyImage")(e.image),width:"100px",height:"100px"}})])],1)})),0)])},_=[],C={mixins:[u.P],props:{profileFollowings:{type:Array,required:!0,default:function(){return[]}}}},F=C,b=(0,v.Z)(F,g,_,!1,null,null,null),x=b.exports,U=function(){var r=this,e=r.$createElement,t=r._self._c||e;return t("div",{staticClass:"container my-2"},[t("div",{staticClass:"row"},[t("h4",[r._v(" Followers(追隨者)： "+r._s(r.profileFollowers.length)+" ")])]),t("div",{staticClass:"row"},r._l(r.profileFollowers,(function(e){return t("div",{key:e.id,staticClass:"col-4 mb-3"},[t("router-link",{attrs:{to:{name:"user",params:{id:e.id}}}},[t("img",{attrs:{src:r._f("emptyImage")(e.image),width:"100px",height:"100px"}})])],1)})),0)])},y=[],k={mixins:[u.P],props:{profileFollowers:{type:Array,required:!0,default:function(){return[]}}}},Z=k,P=(0,v.Z)(Z,U,y,!1,null,null,null),R=P.exports,E=function(){var r=this,e=r.$createElement,t=r._self._c||e;return t("div",{staticClass:"container my-2"},[t("div",{staticClass:"row"},[t("h4",[r._v(" 已評論餐廳數： "+r._s(r.profileComments.length)+" ")])]),t("div",{staticClass:"row"},r._l(r.profileComments,(function(e){return t("div",{key:e.id,staticClass:"col-2 mb-3"},[t("router-link",{attrs:{to:{name:"restaurant",params:{id:e.id}}}},[t("img",{attrs:{src:r._f("emptyImage")(e.Restaurant.image),width:"100px",height:"100px"}})])],1)})),0)])},I=[],$={mixins:[u.P],props:{profileComments:{type:Array,required:!0,default:function(){return[]}}}},q=$,A=(0,v.Z)(q,E,I,!1,null,null,null),j=A.exports,O=function(){var r=this,e=r.$createElement,t=r._self._c||e;return t("div",{staticClass:"container my-2"},[t("div",{staticClass:"row"},[t("h4",[r._v(" 收藏餐廳數： "+r._s(r.profileFavoritedRestaurants.length)+" ")])]),t("div",{staticClass:"row"},r._l(r.profileFavoritedRestaurants,(function(e){return t("div",{key:e.id,staticClass:"col-2 mb-3"},[t("router-link",{attrs:{to:{name:"restaurant",params:{id:e.id}}}},[t("img",{attrs:{src:r._f("emptyImage")(e.image),width:"100px",height:"100px"}})])],1)})),0)])},B=[],z={mixins:[u.P],props:{profileFavoritedRestaurants:{type:Array,required:!0,default:function(){return[]}}}},D=z,G=(0,v.Z)(D,O,B,!1,null,null,null),H=G.exports,J=t(34665),K={name:"User",components:{UserProfileCard:w,UserFollowingsCard:x,UserFollowersCard:R,UserCommentsCard:j,UserFavoritedRestaurantsCard:H},data:function(){return{profile:{}}},computed:(0,l.Z)({},(0,J.rn)(["currentUser"])),methods:{fetchUser:function(r){var e=this;return(0,o.Z)((0,n.Z)().mark((function t(){var s,i;return(0,n.Z)().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,d.Z.get({userId:r});case 3:s=t.sent,i=s.data,console.log("data",i),e.profile=i.profile,t.next=13;break;case 9:t.prev=9,t.t0=t["catch"](0),console.log("error",t.t0),p.F.fire({icon:"error",title:"無法取得 User 資料，請稍後再試"});case 13:case"end":return t.stop()}}),t,null,[[0,9]])})))()}},mounted:function(){var r=this.$route.params.id;this.fetchUser(r)},beforeRouteUpdate:function(r,e,t){var s=r.params.id;this.fetchUser(s),t()}},L=K,M=(0,v.Z)(L,s,i,!1,null,null,null),N=M.exports}}]);
//# sourceMappingURL=691-legacy.96fcc650.js.map